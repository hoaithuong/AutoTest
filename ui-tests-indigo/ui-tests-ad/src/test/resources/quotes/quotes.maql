CREATE FOLDER {dim.quotes} VISUAL(TITLE "Quotes") TYPE ATTRIBUTE;
CREATE FOLDER {ffld.quotes} VISUAL(TITLE "Quotes") TYPE FACT;
CREATE DATASET {dataset.quotes} VISUAL(TITLE "Quotes");
INCLUDE TEMPLATE "URN:GOODDATA:DATE" MODIFY (IDENTIFIER "quote", TITLE "Quote");
CREATE ATTRIBUTE {attr.quotes.id} VISUAL(TITLE "Id", FOLDER {dim.quotes}) AS KEYS {f_quotes.id} FULLSET;
ALTER DATASET {dataset.quotes} ADD {attr.quotes.id};
ALTER ATTRIBUTE {attr.quotes.id} ADD LABELS {label.quotes.id} VISUAL(TITLE "Id") AS {f_quotes.nm_id};
CREATE ATTRIBUTE {attr.quotes.sector} VISUAL(TITLE "Sector", FOLDER {dim.quotes}) AS KEYS {d_quotes_sector.id} FULLSET, {f_quotes.sector_id};
ALTER DATASET {dataset.quotes} ADD {attr.quotes.sector};
ALTER ATTRIBUTE {attr.quotes.sector} ADD LABELS {label.quotes.sector} VISUAL(TITLE "Sector") AS {d_quotes_sector.nm_sector};
ALTER ATTRIBUTE {attr.quotes.sector} DEFAULT LABEL {label.quotes.sector};
CREATE ATTRIBUTE {attr.quotes.market} VISUAL(TITLE "Market", FOLDER {dim.quotes}) AS KEYS {d_quotes_market.id} FULLSET, {f_quotes.market_id};
ALTER DATASET {dataset.quotes} ADD {attr.quotes.market};
ALTER ATTRIBUTE {attr.quotes.market} ADD LABELS {label.quotes.market} VISUAL(TITLE "Market") AS {d_quotes_market.nm_market};
ALTER ATTRIBUTE {attr.quotes.market} DEFAULT LABEL {label.quotes.market};
CREATE ATTRIBUTE {attr.quotes.symbol} VISUAL(TITLE "Symbol", FOLDER {dim.quotes}) AS KEYS {d_quotes_symbol.id} FULLSET, {f_quotes.symbol_id};
ALTER DATASET {dataset.quotes} ADD {attr.quotes.symbol};
ALTER ATTRIBUTE {attr.quotes.symbol} ADD LABELS {label.quotes.symbol.company} VISUAL(TITLE "Company") AS {d_quotes_symbol.nm_company};
ALTER ATTRIBUTE {attr.quotes.symbol} ADD LABELS {label.quotes.symbol} VISUAL(TITLE "Symbol") AS {d_quotes_symbol.nm_symbol};
ALTER ATTRIBUTE {attr.quotes.symbol} DEFAULT LABEL {label.quotes.symbol};
CREATE ATTRIBUTE {attr.quotes.industry} VISUAL(TITLE "Industry", FOLDER {dim.quotes}) AS KEYS {d_quotes_industry.id} FULLSET, {f_quotes.industry_id};
ALTER DATASET {dataset.quotes} ADD {attr.quotes.industry};
ALTER ATTRIBUTE {attr.quotes.industry} ADD LABELS {label.quotes.industry} VISUAL(TITLE "Industry") AS {d_quotes_industry.nm_industry};
ALTER ATTRIBUTE {attr.quotes.industry} DEFAULT LABEL {label.quotes.industry};
CREATE FACT {fact.quotes.open_price} VISUAL(TITLE "Open Price", FOLDER {ffld.quotes}) AS {f_quotes.f_open_price};
ALTER DATASET {dataset.quotes} ADD {fact.quotes.open_price};
CREATE FACT {fact.quotes.high_price} VISUAL(TITLE "High Price", FOLDER {ffld.quotes}) AS {f_quotes.f_high_price};
ALTER DATASET {dataset.quotes} ADD {fact.quotes.high_price};
CREATE FACT {fact.quotes.low_price} VISUAL(TITLE "Low Price", FOLDER {ffld.quotes}) AS {f_quotes.f_low_price};
ALTER DATASET {dataset.quotes} ADD {fact.quotes.low_price};
CREATE FACT {fact.quotes.close_price} VISUAL(TITLE "Close Price", FOLDER {ffld.quotes}) AS {f_quotes.f_close_price};
ALTER DATASET {dataset.quotes} ADD {fact.quotes.close_price};
CREATE FACT {fact.quotes.volume} VISUAL(TITLE "Volume", FOLDER {ffld.quotes}) AS {f_quotes.f_volume};
ALTER DATASET {dataset.quotes} ADD {fact.quotes.volume};
CREATE FACT {fact.quotes.adjusted_close_price} VISUAL(TITLE "Adjusted Close Price", FOLDER {ffld.quotes}) AS {f_quotes.f_adjusted_close_price};
ALTER DATASET {dataset.quotes} ADD {fact.quotes.adjusted_close_price};
ALTER ATTRIBUTE {quote.date} ADD KEYS {f_quotes.dt_quote_id};
SYNCHRONIZE {dataset.quotes} PRESERVE DATA;
