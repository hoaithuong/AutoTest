CREATE DATASET {dataset.city} VISUAL(TITLE "city", DESCRIPTION "city");CREATE DATASET {dataset.people} VISUAL(TITLE "people", DESCRIPTION "people");CREATE DATASET {dataset.district} VISUAL(TITLE "district", DESCRIPTION "district");INCLUDE TEMPLATE "urn:custom_v2:date" MODIFY (IDENTIFIER "createddate", TITLE "createddate");INCLUDE TEMPLATE "urn:keboola:date" MODIFY (IDENTIFIER "birthday", TITLE "birthday");CREATE FOLDER {dim.people} VISUAL(TITLE "people") TYPE ATTRIBUTE;CREATE ATTRIBUTE {attr.people.peopleid} VISUAL(TITLE "peopleid", DESCRIPTION "peopleid", FOLDER {dim.people}) AS KEYS {f_people.id} FULLSET;ALTER DATASET {dataset.people} ADD {attr.people.peopleid};ALTER ATTRIBUTE {attr.people.peopleid} ADD LABELS {label.people.peopleid} VISUAL(TITLE "peopleid") AS {f_people.nm_peopleid};CREATE ATTRIBUTE {attr.people.peoplename} VISUAL(TITLE "peoplename", DESCRIPTION "peoplename", FOLDER {dim.people}) AS KEYS {d_people_peoplename.id} FULLSET, {f_people.peoplename_id};ALTER DATASET {dataset.people} ADD {attr.people.peoplename};ALTER ATTRIBUTE {attr.people.peoplename} ADD LABELS {label.people.peoplename} VISUAL(TITLE "peoplename") AS {d_people_peoplename.nm_peoplename};CREATE FOLDER {dim.city} VISUAL(TITLE "city") TYPE ATTRIBUTE;CREATE ATTRIBUTE {attr.city.cityid} VISUAL(TITLE "cityid", DESCRIPTION "cityid", FOLDER {dim.city}) AS KEYS {f_city.id} FULLSET;ALTER DATASET {dataset.city} ADD {attr.city.cityid};ALTER ATTRIBUTE {attr.city.cityid} ADD LABELS {label.city.cityid} VISUAL(TITLE "cityid") AS {f_city.nm_cityid};CREATE ATTRIBUTE {attr.city.cityname} VISUAL(TITLE "cityname", DESCRIPTION "cityname", FOLDER {dim.city}) AS KEYS {d_city_cityname.id} FULLSET, {f_city.cityname_id};ALTER DATASET {dataset.city} ADD {attr.city.cityname};ALTER ATTRIBUTE {attr.city.cityname} ADD LABELS {label.city.cityname} VISUAL(TITLE "cityname") AS {d_city_cityname.nm_cityname};CREATE FOLDER {dim.district} VISUAL(TITLE "district") TYPE ATTRIBUTE;CREATE ATTRIBUTE {attr.district.factsof} VISUAL(TITLE "Records of district", DESCRIPTION "Records of district", FOLDER {dim.district}) AS KEYS {f_district.id} FULLSET;ALTER DATASET {dataset.district} ADD {attr.district.factsof};CREATE ATTRIBUTE {attr.district.districtid} VISUAL(TITLE "districtid", DESCRIPTION "districtid", FOLDER {dim.district}) AS KEYS {d_district_districtid.id} FULLSET, {f_district.districtid_id};ALTER DATASET {dataset.district} ADD {attr.district.districtid};ALTER ATTRIBUTE {attr.district.districtid} ADD LABELS {label.district.districtid} VISUAL(TITLE "districtid") AS {d_district_districtid.nm_districtid};CREATE ATTRIBUTE {attr.district.districtname} VISUAL(TITLE "districtname", DESCRIPTION "districtname", FOLDER {dim.district}) AS KEYS {d_district_districtname.id} FULLSET, {f_district.districtname_id};ALTER DATASET {dataset.district} ADD {attr.district.districtname};ALTER ATTRIBUTE {attr.district.districtname} ADD LABELS {label.district.districtname} VISUAL(TITLE "districtname") AS {d_district_districtname.nm_districtname};CREATE FOLDER {ffld.people} VISUAL(TITLE "people") TYPE FACT;CREATE FACT {fact.people.salary} VISUAL(TITLE "salary", DESCRIPTION "salary", FOLDER {ffld.people}) AS {f_people.f_salary};ALTER DATASET {dataset.people} ADD {fact.people.salary};CREATE FOLDER {ffld.city} VISUAL(TITLE "city") TYPE FACT;CREATE FACT {fact.city.population} VISUAL(TITLE "population", DESCRIPTION "population", FOLDER {ffld.city}) AS {f_city.f_population};ALTER DATASET {dataset.city} ADD {fact.city.population};CREATE FOLDER {ffld.district} VISUAL(TITLE "district") TYPE FACT;CREATE FACT {fact.district.tax} VISUAL(TITLE "tax", DESCRIPTION "tax", FOLDER {ffld.district}) AS {f_district.f_tax};ALTER DATASET {dataset.district} ADD {fact.district.tax};ALTER ATTRIBUTE {createddate.date} ADD KEYS {f_city.dt_createddate_id};ALTER ATTRIBUTE {birthday.keboola.date} ADD KEYS {f_people.dt_birthday_keboola_id};ALTER ATTRIBUTE {attr.city.cityid} ADD KEYS {f_people.city_id};ALTER ATTRIBUTE {attr.city.cityid} ADD KEYS {f_district.city_id};SYNCHRONIZE {dataset.people}, {dataset.district}, {dataset.city};
