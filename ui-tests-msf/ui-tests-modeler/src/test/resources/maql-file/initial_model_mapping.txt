CREATE DATASET {dataset.school} VISUAL(TITLE "school", DESCRIPTION "school");CREATE DATASET {dataset.student} VISUAL(TITLE "student", DESCRIPTION "student");INCLUDE TEMPLATE "urn:custom_v2:date" MODIFY (IDENTIFIER "createddate", TITLE "createddate");INCLUDE TEMPLATE "urn:keboola:date" MODIFY (IDENTIFIER "birthday", TITLE "birthday");CREATE FOLDER {dim.school} VISUAL(TITLE "school") TYPE ATTRIBUTE;CREATE ATTRIBUTE {attr.school.schoolid} VISUAL(TITLE "schoolid", DESCRIPTION "schoolid", FOLDER {dim.school}) AS KEYS {f_school.id} FULLSET;ALTER DATASET {dataset.school} ADD {attr.school.schoolid};ALTER ATTRIBUTE {attr.school.schoolid} ADD LABELS {label.school.schoolid} VISUAL(TITLE "schoolid") AS {f_school.nm_schoolid};CREATE ATTRIBUTE {attr.school.schoolname} VISUAL(TITLE "schoolname", DESCRIPTION "schoolname", FOLDER {dim.school}) AS KEYS {d_school_schoolname.id} FULLSET, {f_school.schoolname_id};ALTER DATASET {dataset.school} ADD {attr.school.schoolname};ALTER ATTRIBUTE {attr.school.schoolname} ADD LABELS {label.school.schoolname} VISUAL(TITLE "schoolname") AS {d_school_schoolname.nm_schoolname};CREATE FOLDER {dim.student} VISUAL(TITLE "student") TYPE ATTRIBUTE;CREATE ATTRIBUTE {attr.student.studentid} VISUAL(TITLE "studentid", DESCRIPTION "studentid", FOLDER {dim.student}) AS KEYS {d_student_studentid.id} FULLSET, {f_student.studentid_id};ALTER DATASET {dataset.student} ADD {attr.student.studentid};ALTER ATTRIBUTE {attr.student.studentid} ADD LABELS {label.student.studentid} VISUAL(TITLE "studentid") AS {d_student_studentid.nm_studentid};CREATE ATTRIBUTE {attr.student.studentcode} VISUAL(TITLE "studentcode", DESCRIPTION "studentcode", FOLDER {dim.student}) AS KEYS {d_student_studentcode.id} FULLSET, {f_student.studentcode_id};ALTER DATASET {dataset.student} ADD {attr.student.studentcode};ALTER ATTRIBUTE {attr.student.studentcode} ADD LABELS {label.student.studentcode} VISUAL(TITLE "studentcode") AS {d_student_studentcode.nm_studentcode};CREATE FOLDER {ffld.school} VISUAL(TITLE "school") TYPE FACT;CREATE FACT {fact.school.total} VISUAL(TITLE "total", DESCRIPTION "total", FOLDER {ffld.school}) AS {f_school.f_total};ALTER DATASET {dataset.school} ADD {fact.school.total};CREATE FOLDER {ffld.student} VISUAL(TITLE "student") TYPE FACT;CREATE FACT {fact.student.age} VISUAL(TITLE "age", DESCRIPTION "age", FOLDER {ffld.student}) AS {f_student.f_age};ALTER DATASET {dataset.student} ADD {fact.student.age};ALTER ATTRIBUTE {birthday.keboola.date} ADD KEYS {f_student.dt_birthday_keboola_id};CREATE ATTRIBUTE {attr.student.factsof} VISUAL(TITLE "Records of student", DESCRIPTION "Records of student", FOLDER {dim.student}) AS KEYS {f_student.factsof_id} PRIMARY SET GRAIN {attr.student.studentcode}, {attr.student.studentid};ALTER DATASET {dataset.student} ADD {attr.student.factsof};SYNCHRONIZE {dataset.school}, {dataset.student};
