CREATE DATASET {dataset.salary} VISUAL(TITLE "Salary");
CREATE DATASET {dataset.employee} VISUAL(TITLE "Employee");
CREATE DATASET {dataset.department} VISUAL(TITLE "Department");
INCLUDE TEMPLATE "urn:broadcast:date" MODIFY (IDENTIFIER "salary", TITLE "Salary");
CREATE ATTRIBUTE {attr.salary.salary} VISUAL(TITLE "Salary") AS KEYS {f_salary.id} FULLSET;
ALTER DATASET {dataset.salary} ADD {attr.salary.salary};
ALTER ATTRIBUTE {attr.salary.salary} ADD LABELS {label.salary.salary} VISUAL(TITLE "Salary") AS {f_salary.nm_salary};
CREATE ATTRIBUTE {attr.employee.employee} VISUAL(TITLE "Employee") AS KEYS {f_employee.id} FULLSET;
ALTER DATASET {dataset.employee} ADD {attr.employee.employee};
ALTER ATTRIBUTE {attr.employee.employee} ADD LABELS {label.employee.employee.firstname} VISUAL(TITLE "Firstname") AS {f_employee.nm_firstname};
ALTER ATTRIBUTE {attr.employee.employee} ADD LABELS {label.employee.employee.lastname} VISUAL(TITLE "Lastname") AS {f_employee.nm_lastname};
ALTER ATTRIBUTE {attr.employee.employee} ADD LABELS {label.employee.employee} VISUAL(TITLE "Employee") AS {f_employee.nm_employee};
CREATE ATTRIBUTE {attr.department.department} VISUAL(TITLE "Department") AS KEYS {f_department.id} FULLSET;
ALTER DATASET {dataset.department} ADD {attr.department.department};
ALTER ATTRIBUTE {attr.department.department} ADD LABELS {label.department.department.name} VISUAL(TITLE "Name") AS {f_department.nm_name};
ALTER ATTRIBUTE {attr.department.department} ADD LABELS {label.department.department} VISUAL(TITLE "Department") AS {f_department.nm_department};
CREATE FACT {fact.salary.payment} VISUAL(TITLE "Payment") AS {f_salary.f_payment};
ALTER DATASET {dataset.salary} ADD {fact.salary.payment};
ALTER ATTRIBUTE {salary.broadcast_date} ADD KEYS {f_salary.dt_salary_id};
ALTER ATTRIBUTE {attr.employee.employee} ADD KEYS {f_salary.employee_id};
ALTER ATTRIBUTE {attr.department.department} ADD KEYS {f_employee.department_id};
SYNCHRONIZE {dataset.employee}, {dataset.department}, {dataset.salary};