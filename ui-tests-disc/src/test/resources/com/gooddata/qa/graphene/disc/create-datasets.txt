CREATE FOLDER {dim.salesforce} VISUAL(TITLE "Salesforce") TYPE ATTRIBUTE;
CREATE FOLDER {ffld.salesforce} VISUAL(TITLE "Salesforce") TYPE FACT;
CREATE DATASET {dataset.salesforce} VISUAL(TITLE "Salesforce");
INCLUDE TEMPLATE "URN:GOODDATA:DATE" MODIFY (IDENTIFIER "createdsfdc", TITLE "CreatedSFDC");
INCLUDE TEMPLATE "URN:GOODDATA:DATE" MODIFY (IDENTIFIER "closedsfdc", TITLE "ClosedSFDC");
CREATE ATTRIBUTE {attr.salesforce.id} VISUAL(TITLE "Salesforce Id", FOLDER {dim.salesforce}) AS KEYS {f_salesforce.id} FULLSET;
ALTER DATASET {dataset.salesforce} ADD {attr.salesforce.id};
ALTER ATTRIBUTE {attr.salesforce.id} ADD LABELS {label.salesforce.id} VISUAL(TITLE "Salesforce Id") AS {f_salesforce.nm_id};
ALTER ATTRIBUTE {attr.salesforce.id} DEFAULT LABEL {label.salesforce.id};
CREATE ATTRIBUTE {attr.salesforce.isclosed} VISUAL(TITLE "Is Closed", FOLDER {dim.salesforce}) AS KEYS {d_salesforce_isclosed.id} FULLSET, {f_salesforce.isclosed_id};
ALTER DATASET {dataset.salesforce} ADD {attr.salesforce.isclosed};
ALTER ATTRIBUTE {attr.salesforce.isclosed} ADD LABELS {label.salesforce.isclosed} VISUAL(TITLE "Is Closed") AS {d_salesforce_isclosed.nm_isclosed};
ALTER ATTRIBUTE {attr.salesforce.isclosed} DEFAULT LABEL {label.salesforce.isclosed};
CREATE ATTRIBUTE {attr.salesforce.iswon} VISUAL(TITLE "Is Won", FOLDER {dim.salesforce}) AS KEYS {d_salesforce_iswon.id} FULLSET, {f_salesforce.iswon_id};
ALTER DATASET {dataset.salesforce} ADD {attr.salesforce.iswon};
ALTER ATTRIBUTE {attr.salesforce.iswon} ADD LABELS {label.salesforce.iswon} VISUAL(TITLE "Is Won") AS {d_salesforce_iswon.nm_iswon};
ALTER ATTRIBUTE {attr.salesforce.iswon} DEFAULT LABEL {label.salesforce.iswon};
CREATE ATTRIBUTE {attr.salesforce.stagename} VISUAL(TITLE "Stage", FOLDER {dim.salesforce}) AS KEYS {d_salesforce_stagename.id} FULLSET, {f_salesforce.stagename_id};
ALTER DATASET {dataset.salesforce} ADD {attr.salesforce.stagename};
ALTER ATTRIBUTE {attr.salesforce.stagename} ADD LABELS {label.salesforce.stagename} VISUAL(TITLE "Stage") AS {d_salesforce_stagename.nm_stagename};
ALTER ATTRIBUTE {attr.salesforce.stagename} DEFAULT LABEL {label.salesforce.stagename};
CREATE ATTRIBUTE {attr.salesforce.account} VISUAL(TITLE "Account", FOLDER {dim.salesforce}) AS KEYS {d_salesforce_account.id} FULLSET, {f_salesforce.account_id};
ALTER DATASET {dataset.salesforce} ADD {attr.salesforce.account};
ALTER ATTRIBUTE {attr.salesforce.account} ADD LABELS {label.salesforce.account} VISUAL(TITLE "Account") AS {d_salesforce_account.nm_account};
ALTER ATTRIBUTE {attr.salesforce.account} DEFAULT LABEL {label.salesforce.account};
CREATE FACT {fact.salesforce.amount} VISUAL(TITLE "Amount", FOLDER {ffld.salesforce}) AS {f_salesforce.f_amount};
ALTER DATASET {dataset.salesforce} ADD {fact.salesforce.amount};
CREATE FACT {dt.salesforce.createdsfdc} VISUAL(TITLE "Date fact crated") AS {f_salesforce.f_createdsfdc};
ALTER DATATYPE {f_salesforce.f_createdsfdc} INT;
ALTER DATASET {dataset.salesforce} ADD {dt.salesforce.createdsfdc};
CREATE FACT {dt.salesforce.closedsfdc} VISUAL(TITLE "Date fact closed") AS {f_salesforce.f_closedsfdc};
ALTER DATATYPE {f_salesforce.f_closedsfdc} INT;
ALTER DATASET {dataset.salesforce} ADD {dt.salesforce.closedsfdc};
ALTER ATTRIBUTE {createdsfdc.date} ADD KEYS {f_salesforce.dt_createdsfdc_id};
ALTER ATTRIBUTE {closedsfdc.date} ADD KEYS {f_salesforce.dt_closedsfdc_id};
SYNCHRONIZE {dataset.salesforce} PRESERVE DATA;

INCLUDE TEMPLATE "URN:GOODDATA:DATE" MODIFY (IDENTIFIER "first", TITLE "first");
INCLUDE TEMPLATE "URN:GOODDATA:DATE" MODIFY (IDENTIFIER "second", TITLE "second");
INCLUDE TEMPLATE "URN:GOODDATA:DATE" MODIFY (IDENTIFIER "third", TITLE "third");
INCLUDE TEMPLATE "URN:GOODDATA:DATE" MODIFY (IDENTIFIER "fourth", TITLE "fourth");
INCLUDE TEMPLATE "URN:GOODDATA:DATE" MODIFY (IDENTIFIER "fifth", TITLE "fifth");
CREATE DATASET {dataset.test} VISUAL(TITLE "test");CREATE ATTRIBUTE {attr.test.id} VISUAL(TITLE "id") AS KEYS {d_test_id.id} FULLSET, {f_test.id_id};
ALTER DATASET {dataset.test} ADD {attr.test.id};
ALTER ATTRIBUTE {attr.test.id} ADD LABELS {label.test.id} VISUAL(TITLE "id") AS {d_test_id.nm_id};
ALTER ATTRIBUTE {attr.test.id} DEFAULT LABEL {label.test.id};
CREATE ATTRIBUTE {attr.test.name} VISUAL(TITLE "name") AS KEYS {d_test_name.id} FULLSET, {f_test.name_id};
ALTER DATASET {dataset.test} ADD {attr.test.name};
ALTER ATTRIBUTE {attr.test.name} ADD LABELS {label.test.name} VISUAL(TITLE "name") AS {d_test_name.nm_name};
ALTER ATTRIBUTE {attr.test.name} DEFAULT LABEL {label.test.name};
CREATE FACT {fact.test.amount} VISUAL(TITLE "amount") AS {f_test.f_amount};
ALTER DATASET {dataset.test} ADD {fact.test.amount};
CREATE FACT {dt.test.first_date} VISUAL(TITLE "First Date (Date)") AS {f_test.dt_first_date};
ALTER DATASET {dataset.test} ADD {dt.test.first_date};
ALTER DATATYPE {f_test.dt_first_date} INT;
CREATE FACT {dt.test.second_date} VISUAL(TITLE "Second Date (Date)") AS {f_test.dt_second_date};
ALTER DATASET {dataset.test} ADD {dt.test.second_date};
ALTER DATATYPE {f_test.dt_second_date} INT;
CREATE FACT {dt.test.third_date} VISUAL(TITLE "Third Date (Date)") AS {f_test.dt_third_date};
ALTER DATASET {dataset.test} ADD {dt.test.third_date};
ALTER DATATYPE {f_test.dt_third_date} INT;
ALTER ATTRIBUTE {first.date} ADD KEYS {f_test.dt_first_id};
ALTER ATTRIBUTE {second.date} ADD KEYS {f_test.dt_second_id};
ALTER ATTRIBUTE {third.date} ADD KEYS {f_test.dt_third_id};
ALTER ATTRIBUTE {fourth.date} ADD KEYS {f_test.dt_fourth_id};
ALTER ATTRIBUTE {fifth.date} ADD KEYS {f_test.dt_fifth_id};
CREATE ATTRIBUTE {attr.test.factsof} VISUAL(TITLE "Records of test") AS KEYS {f_test.id} FULLSET;
ALTER DATASET {dataset.test} ADD {attr.test.factsof};
SYNCHRONIZE {dataset.test};